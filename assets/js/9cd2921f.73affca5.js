"use strict";(self.webpackChunkstryker_mutator_github_io=self.webpackChunkstryker_mutator_github_io||[]).push([[4365],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=u(n),m=o,h=d["".concat(l,".").concat(m)]||d[m]||c[m]||a;return n?r.createElement(h,s(s({ref:t},p),{},{components:n})):r.createElement(h,s({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var u=2;u<a;u++)s[u]=n[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5466:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return s},default:function(){return c},frontMatter:function(){return a},metadata:function(){return i},toc:function(){return u}});n(7294);var r=n(3905);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}const a={title:"Troubleshooting",custom_edit_url:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/troubleshooting.md"},s=void 0,i={unversionedId:"stryker-js/troubleshooting",id:"stryker-js/troubleshooting",title:"Troubleshooting",description:"Below you'll find an ever-growing list of issues that you might occur when running StrykerJS on your project for the first time.",source:"@site/docs/stryker-js/troubleshooting.md",sourceDirName:"stryker-js",slug:"/stryker-js/troubleshooting",permalink:"/docs/stryker-js/troubleshooting",draft:!1,editUrl:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/troubleshooting.md",tags:[],version:"current",frontMatter:{title:"Troubleshooting",custom_edit_url:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/troubleshooting.md"},sidebar:"docs",previous:{title:"TypeScript Checker",permalink:"/docs/stryker-js/typescript-checker"},next:{title:"Angular",permalink:"/docs/stryker-js/guides/angular"}},l={},u=[{value:"Build command fails",id:"build-command-fails",level:3},{value:"Initial test run fails",id:"initial-test-run-fails",level:3},{value:"No tests executed - Jest runner",id:"no-tests-executed---jest-runner",level:3},{value:"All mutants survive - Jest runner",id:"all-mutants-survive---jest-runner",level:3},{value:"Jest crashes with a multi project configuration",id:"jest-crashes-with-a-multi-project-configuration",level:3},{value:"Stryker generates mutants that survive, but are not compiled by TypeScript",id:"stryker-generates-mutants-that-survive-but-are-not-compiled-by-typescript",level:3},{value:"Error when running StrykerJS: <code>Committing semi space failed. Allocation failed - JavaScript heap out of memory</code>",id:"error-when-running-strykerjs-committing-semi-space-failed-allocation-failed---javascript-heap-out-of-memory",level:3},{value:"Mutating fails: Cannot use the decorators and decorators-legacy plugin together",id:"mutating-fails-cannot-use-the-decorators-and-decorators-legacy-plugin-together",level:3},{value:"Mutants survive but should be killed - Jest runner",id:"mutants-survive-but-should-be-killed---jest-runner",level:3},{value:"Error when running Stryker with the TypeScript checker: no watcher is registered.",id:"error-when-running-stryker-with-the-typescript-checker-no-watcher-is-registered",level:3},{value:"Plugins can&#39;t be found when using pnpm as package manager",id:"plugins-cant-be-found-when-using-pnpm-as-package-manager",level:3}],p={toc:u};function c({components:e,...t}){return(0,r.kt)("wrapper",o({},p,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Below you'll find an ever-growing list of issues that you might occur when running StrykerJS on your project for the first time."),(0,r.kt)("h3",o({},{id:"build-command-fails"}),"Build command fails"),(0,r.kt)("p",null,"Example:"),(0,r.kt)("blockquote",null,(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",o({parentName:"pre"},{})," ERROR Stryker Unexpected error occurred while running Stryker Error: Command failed with exit code 1:\n my-build-command\n"))),(0,r.kt)("p",null,"If you're running into issues with your ",(0,r.kt)("inlineCode",{parentName:"p"},"buildCommand"),", try to execute it by hand to make sure it works. For example, if your ",(0,r.kt)("inlineCode",{parentName:"p"},"buildCommand")," is ",(0,r.kt)("inlineCode",{parentName:"p"},'"tsc -b path/to/tsconfig.json"'),", try to run ",(0,r.kt)("inlineCode",{parentName:"p"},"npx tsc  -b path/to/tsconfig.json")," yourself, did it have the desired effect?"),(0,r.kt)("p",null,"If that works, the next step would be to try the command yourself ",(0,r.kt)("em",{parentName:"p"},"inside the Stryker sandbox directory"),". Please ",(0,r.kt)("inlineCode",{parentName:"p"},"cd")," into the ",(0,r.kt)("inlineCode",{parentName:"p"},".stryker-tmp/sandbox-xxxxx")," directory and try the command there. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-shell"}),"cd .stryker-tmp/sandbox-12345678\nnode ../../node_modules/typescript/bin/tsc -b path/to/tsconfig.json\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note"),": since the sandbox dir doesn't have you node_modules, you will need to specify the full path to the TypeScript compiler."),(0,r.kt)("h3",o({},{id:"initial-test-run-fails"}),"Initial test run fails"),(0,r.kt)("p",null,"Example:"),(0,r.kt)("blockquote",null,(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",o({parentName:"pre"},{}),"One or more tests resulted in an error\n[...] Cannot assign to 'stryNS_9fa48' because it is not a variable [...]\n"))),(0,r.kt)("p",null,"The initial test run might fail when you're using ts-jest or ts-node. The reason for this is that Stryker will mutate your code and, by doing so, introduce type errors into your code. Stryker tries to ignore these errors by adding ",(0,r.kt)("a",o({parentName:"p"},{href:"https://devblogs.microsoft.com/typescript/announcing-typescript-3-7/#ts-nocheck-in-typescript-files"}),(0,r.kt)("inlineCode",{parentName:"a"},"// @ts-nocheck"))," in your source files. However, this is only done for TypeScript-like files inside your ",(0,r.kt)("inlineCode",{parentName:"p"},"lib"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"src"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"test")," directories by default. If you have your code somewhere else, you will need to override ",(0,r.kt)("a",o({parentName:"p"},{href:"/docs/stryker-js/configuration#disabletypechecks-false--true--string"}),"disableTypeChecks")," yourself:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-json"}),'{\n  "disableTypeChecks": "app/**/*.{js,ts,jsx,tsx,html,vue}"\n}\n')),(0,r.kt)("p",null,"Another cause might be that you're using TypeScript lower then v3.7. In that case, you should update TypeScript to at least v3.7 or higher. Alternatively you can try to switch to another transpiler, like ",(0,r.kt)("a",o({parentName:"p"},{href:"https://babeljs.io/docs/en/babel-preset-typescript"}),"babel"),", but honestly, updating TypeScript should be your first choice."),(0,r.kt)("h3",o({},{id:"no-tests-executed---jest-runner"}),"No tests executed - Jest runner"),(0,r.kt)("p",null,"You might run into issues like this when using the ",(0,r.kt)("inlineCode",{parentName:"p"},"@stryker-mutator/jest-runner"),":"),(0,r.kt)("blockquote",null,(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",o({parentName:"pre"},{}),"No tests found, exiting with code 1\nRun with `--passWithNoTests` to exit with code 0\n"))),(0,r.kt)("p",null,"You will need to override the ",(0,r.kt)("inlineCode",{parentName:"p"},"tempDirName")," to a directory without a ",(0,r.kt)("inlineCode",{parentName:"p"},".")," in front of it."),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-json"}),'{\n   "tempDirName": "stryker-tmp"\n}\n')),(0,r.kt)("p",null,"See ",(0,r.kt)("a",o({parentName:"p"},{href:"https://github.com/stryker-mutator/stryker-js/issues/1691"}),"#1691")," for more info."),(0,r.kt)("h3",o({},{id:"all-mutants-survive---jest-runner"}),"All mutants survive - Jest runner"),(0,r.kt)("p",null,"When running with the ",(0,r.kt)("inlineCode",{parentName:"p"},"@stryker-mutator/jest-runner")," on windows you might run into the issue where all mutants survive unexpectedly:"),(0,r.kt)("blockquote",null,(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",o({parentName:"pre"},{}),"[...]\n#3. [Survived] ArithmeticOperator\nC:\\z\\github\\stryker-mutator\\stryker-js\\e2e\\test\\jest-node\\src\\sum.js:5:10\n-     return a - b;\n+     return a + b;\nRan all tests for this mutant.\n\nRan 0.00 tests per mutant on average.\n----------|---------|----------|-----------|------------|----------|---------|\nFile      | % score | # killed | # timeout | # survived | # no cov | # error |\n----------|---------|----------|-----------|------------|----------|---------|\nAll files |    0.00 |        0 |         0 |          4 |        0 |       0 |\n sum.js   |    0.00 |        0 |         0 |          4 |        0 |       0 |\n----------|---------|----------|-----------|------------|----------|---------|\n"))),(0,r.kt)("p",null,"The root cause for this is that Jest doesn't support running in a hidden directory on windows, like StrykerJS does by default (the sandbox directory is located in ",(0,r.kt)("inlineCode",{parentName:"p"},".stryker-tmp"),", a hidden directory). See ",(0,r.kt)("a",o({parentName:"p"},{href:"https://github.com/facebook/jest/issues/9728"}),"issue 9728")," for more info."),(0,r.kt)("p",null,"Known workarounds:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Change the ",(0,r.kt)("a",o({parentName:"li"},{href:"/docs/stryker-js/configuration#tempdirname-string"}),(0,r.kt)("inlineCode",{parentName:"a"},"tempDirName"))," to a non-hidden directory, for example ",(0,r.kt)("inlineCode",{parentName:"li"},"--tempDirName stryker-tmp"),"."),(0,r.kt)("li",{parentName:"ol"},"You can also choose to run Stryker in place, using ",(0,r.kt)("a",o({parentName:"li"},{href:"/docs/stryker-js/configuration#inplace-boolean"}),(0,r.kt)("inlineCode",{parentName:"a"},"--inPlace")))),(0,r.kt)("h3",o({},{id:"jest-crashes-with-a-multi-project-configuration"}),"Jest crashes with a multi project configuration"),(0,r.kt)("p",null,"Example:"),(0,r.kt)("blockquote",null,(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",o({parentName:"pre"},{})," ERROR DryRunExecutor One or more tests resulted in an error:\n        Test runner crashed. Tried twice to restart it without any luck. Last time the error message was:\nError: Jest: Cannot use configuration as an object without a file path.\n    at readConfig (C:\\z\\github\\jest-issue\\node_modules\\jest-config\\build\\index.js:188:13)\n"))),(0,r.kt)("p",null,"This can happen when you have multiple ",(0,r.kt)("a",o({parentName:"p"},{href:"https://jestjs.io/docs/configuration#projects-arraystring--projectconfig"}),(0,r.kt)("inlineCode",{parentName:"a"},'"projects"'))," defined in your Jest configuration. Currently, the jest-runner uses the ",(0,r.kt)("inlineCode",{parentName:"p"},"runCli")," of Jest, which doesn't support this. However, ",(0,r.kt)("a",o({parentName:"p"},{href:"https://github.com/facebook/jest/pull/11307"}),"the PR that adds support for this just merged"),", so future releases of Jest should work. "),(0,r.kt)("p",null,'Until then, the only known workaround is to configure Jest without using "projects" \ud83e\udd37\u200d\u2642\ufe0f.'),(0,r.kt)("h3",o({},{id:"stryker-generates-mutants-that-survive-but-are-not-compiled-by-typescript"}),"Stryker generates mutants that survive, but are not compiled by TypeScript"),(0,r.kt)("p",null,"If you are using TypeScript, it may happen that StrykerJS generates a mutant that survives, but is not compilable by TypeScript."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example"),":"),(0,r.kt)("p",null,"In your production TS code, you have the following statement:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-ts"}),"let typesWithLabelsObjects: ComponentData[] = new Array<ComponentData>();\n")),(0,r.kt)("p",null,"and one of the mutants generated by StrykerJS is the following ",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayMutation")," one:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-ts"}),"let typesWithLabelsObjects: ComponentData[] = new Array([]);\n")),(0,r.kt)("p",null,"However, if you try to introduce such a change to your TypeScript code manually, the TypeScript's compiler will not compile this. In our example, you'd get the following compilation error:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{}),"Type 'any[][]' is not assignable to type 'ComponentData[]'.\n  Type 'any[]' is missing the following properties from type 'ComponentData': type, labelts(2322)\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution"),":"),(0,r.kt)("p",null,"To solve that, you need to add a ",(0,r.kt)("a",o({parentName:"p"},{href:"https://stryker-mutator.io/docs/stryker-js/typescript-checker/#configuring"}),"typescript-checker plugin")," to StrykerJS. Install it with ",(0,r.kt)("inlineCode",{parentName:"p"},"npm install --save-dev @stryker-mutator/typescript-checker")," and then add the following options to your stryker's config file:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{}),'{\n  "checkers": ["typescript"],\n  "tsconfigFile": "tsconfig.json"\n}\n')),(0,r.kt)("p",null,"After adding this and running ",(0,r.kt)("inlineCode",{parentName:"p"},"npx stryker run")," you may get errors similar to this one:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{}),"node_modules/@types/react/index.d.ts:3075:13 - error TS2717: Subsequent property declarations must have the same type.  Property 'rt' must be of type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>', but here has type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>'.\n")),(0,r.kt)("p",null,"If that happens, add ",(0,r.kt)("inlineCode",{parentName:"p"},'"skipLibCheck": true')," to your ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig")," file.\n",(0,r.kt)("strong",{parentName:"p"},"Note"),": adding ",(0,r.kt)("inlineCode",{parentName:"p"},"typescript-checker")," to StrykerJS makes types safety better and you get less false negative results, but it comes with a performance cost. Mutating may take more time with the checker plugin."),(0,r.kt)("h3",o({},{id:"error-when-running-strykerjs-committing-semi-space-failed-allocation-failed---javascript-heap-out-of-memory"}),"Error when running StrykerJS: ",(0,r.kt)("inlineCode",{parentName:"h3"},"Committing semi space failed. Allocation failed - JavaScript heap out of memory")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example"),":"),(0,r.kt)("p",null,"When running Stryker mutations, you may get an error similar to the following one:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{}),"16:58:25 (17452) INFO ConfigReader Using stryker.conf.json\n16:58:26 (17452) INFO InputFileResolver Found 2 of 2557 file(s) to be mutated.\n16:58:27 (17452) INFO Instrumenter Instrumented 2 source file(s) with 118 mutant(s)\n16:58:28 (17452) INFO ConcurrencyTokenProvider Creating 6 checker process(es) and 5 test runner process(es).\n16:59:40 (17452) INFO DryRunExecutor Starting initial test run. This may take a while.\n16:59:53 (17452) INFO DryRunExecutor Initial test run succeeded. Ran 72 tests in 13 seconds (net 250 ms, overhead 12910 ms).\nMutation testing  [  ] 12% (elapsed: ~1m, remaining: ~7m) 15/118 tested (0 survived, 10 timed out)\n<--- Last few GCs ---\x3e\n[17452:0000022998429D50]    75135 ms: Scavenge 302.2 (313.0) -> 295.2 (313.0) MB, 0.8 / 0.2 ms  (average mu = 0.992, current mu = 0.975) task\n[17452:0000022998429D50]   125511 ms: Scavenge 302.0 (313.0) -> 295.9 (313.2) MB, 1.3 / 0.0 ms  (average mu = 0.992, current mu = 0.975) task\n[17452:0000022998429D50]   149148 ms: Scavenge 296.5 (301.2) -> 296.0 (301.7) MB, 2.3 / 0.2 ms  (average mu = 0.992, current mu = 0.975) allocation failure\n<--- JS stacktrace ---\x3e\nFATAL ERROR: Committing semi space failed. Allocation failed - JavaScript heap out of memory\n 1: 00007FF61D741DDF napi_wrap+109135\n 2: 00007FF61D6E6D06 v8::internal::OrderedHashTable<v8::internal::OrderedHashSet,1>::NumberOfElementsOffset+33350\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution"),":"),(0,r.kt)("p",null,"To solve that, you need to limit the number of workers. In the example about, 11 workers were created in total (6 checker processes and 5 test runner processes). In order to solve this issue, you may try to set ",(0,r.kt)("inlineCode",{parentName:"p"},"--concurrency")," setting in your stryker config. In case of the sample issue, adding ",(0,r.kt)("inlineCode",{parentName:"p"},'"concurrency": 4')," to ",(0,r.kt)("inlineCode",{parentName:"p"},"stryker.conf.json")," solved the problem."),(0,r.kt)("h3",o({},{id:"mutating-fails-cannot-use-the-decorators-and-decorators-legacy-plugin-together"}),"Mutating fails: Cannot use the decorators and decorators-legacy plugin together"),(0,r.kt)("p",null,"Example:"),(0,r.kt)("blockquote",null,(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",o({parentName:"pre"},{}),"ERROR Stryker Unexpected error occurred while running Stryker Error: Cannot use the decorators and decorators-legacy plugin together\n   at validatePlugins (okay_all in src\\node_modules\\@babel\\parser\\lib\\index.js:10194:13)\n   at getParser (okay_all in src\\node_modules\\@babel\\parser\\lib\\index.js:14528:5)\n   at parse (okay_all in src\\node_modules\\@babel\\parser\\lib\\index.js:14511:12)\n   at parser (okay_all in src\\node_modules\\@babel\\core\\lib\\parser\\index.js:52:34)\n   at parser.next (<anonymous>)\n   at Object.parse (okay_all in src\\node_modules\\@babel\\core\\lib\\parse.js:31:37)\n   at parse.next (<anonymous>)\n   at step (okay_all in src\\node_modules\\gensync\\index.js:261:32)\n   at okay_all in src\\node_modules\\gensync\\index.js:273:13\n   at async.call.result.err.err (okay_all in src\\node_modules\\gensync\\index.js:223:11)\n"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution"),":"),(0,r.kt)("p",null,"Stryker JS uses ",(0,r.kt)("a",o({parentName:"p"},{href:"https://babeljs.io/docs/en/"}),"babel")," to parse and mutate your files. It does so by reading the ",(0,r.kt)("inlineCode",{parentName:"p"},".babelrc")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"babel.config.js")," files you have, but applies its own default plugins first. In rare circumstances, those default plugins are incompatible with your babel configuration."),(0,r.kt)("p",null,"Override the default babel plugins to solve this issue. For example, leaving it empty allows your own babel plugins to be used, without defaults from StrykerJS conflicting with it:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{}),'{\n  "mutator": {\n    "plugins": []\n  }\n}\n')),(0,r.kt)("p",null,"Alternatively, you can start with the ",(0,r.kt)("a",o({parentName:"p"},{href:"https://github.com/stryker-mutator/stryker-js/blob/0c98f98649cecd7e7222cc5f168afbe1071099e5/packages/instrumenter/src/parsers/js-parser.ts#L8-L32"}),"default list defined in StrykerJS")," and start removing some of them until you get a working list."),(0,r.kt)("h3",o({},{id:"mutants-survive-but-should-be-killed---jest-runner"}),"Mutants survive but should be killed - Jest runner"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Symptom")),(0,r.kt)("p",null,"For a TypeScript file the mutants don't get killed but a coverage (in Jest) is shown."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Problem")),(0,r.kt)("p",null,"The mutated source file is only implementing callbacks for a framework that uses express in the background as a server. The unit tests for this module are written with Jest and are using Axios to make REST calls against the server. There is no module dependency needed for the test. But Stryker is using Jest's ",(0,r.kt)("inlineCode",{parentName:"p"},"--findRelatedTests")," to optimize the performance. And it looks like that this Jest feature is only looking at imports (see this ",(0,r.kt)("a",o({parentName:"p"},{href:"https://stackoverflow.com/questions/44066996/how-does-jest-findrelatedtests-work-under-the-hood"}),"StackOverflow post"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution")),(0,r.kt)("p",null,"There are two solutions for this problem."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Adding an (unused) import for the tested module get the mutants killed. This is not an optimal solution but it works."),(0,r.kt)("p",{parentName:"li"},"Example:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",o({parentName:"pre"},{className:"language-typescript"}),'import {} from "../FileUnderTest";\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Deactivate the usage of this Jest feature by setting ",(0,r.kt)("inlineCode",{parentName:"p"},"--findRelatedTests")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),". See ",(0,r.kt)("a",o({parentName:"p"},{href:"https://stryker-mutator.io/docs/stryker-js/jest-runner/#jestenablefindrelatedtests-boolean"}),"documentation"),"."))),(0,r.kt)("h3",o({},{id:"error-when-running-stryker-with-the-typescript-checker-no-watcher-is-registered"}),"Error when running Stryker with the TypeScript checker: no watcher is registered."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Symptom")),(0,r.kt)("p",null,"When activating the TypeScript checker, you might run into this error:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{}),'22:23:36 (2804) ERROR Stryker Unexpected error occurred while running Stryker StrykerError: \nError: Tried to check file "app/app.component.ts" (which is part of your typescript project), \nbut no watcher is registered for it. Changes would go unnoticed. This probably means that you\nneed to expand the files that are included in your project.\n')),(0,r.kt)("p",null,"This error most often occurs in Angular projects, but can occur in any TS project."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Problem")),(0,r.kt)("p",null,"The problem here is that the TypeScript checker plugin uses the ",(0,r.kt)("inlineCode",{parentName:"p"},"ts.createSolutionBuilderWithWatch")," api. This is equivalent to you running ",(0,r.kt)("inlineCode",{parentName:"p"},"tsc --build --watch"),". This works great, but has one downside, files not explicitly included in your project's tsconfig.json file will not be watched. When files are not watched by the TypeScript compiler, the checker plugin cannot check for type errors for that mutant. "),(0,r.kt)("p",null,"It has to choose to either let this mutant go unchecked or throw an error and stop running. Since you've configured the checker, you probably want the mutants to be checked, thus it makes sense to simply stop mutation testing so you can fix this issue."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution")),(0,r.kt)("p",null,"The solution is to include all files that are mutated in your project's tsconfig.json file. If you have multiple tsconfig.json files, you probably need to change the one you've configured in your stryker.conf.json. For example (for an angular project)"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-diff"}),'{\n  "extends": "./tsconfig.json",\n  "compilerOptions": {\n  "outDir": "./out-tsc/app",\n  "types": []\n-  "files": [\n-   "src/main.ts",\n-   "src/polyfills.ts"\n-  ],\n  "include": [\n-   "src/**/*.d.ts"\n+   "src/**/*.ts",\n+   "src/**/*.d.ts"\n  ],\n+ "exclude": [\n+   "src/**/*.spec.ts"\n+ ]\n}\n')),(0,r.kt)("p",null,"This shouldn't change anything about your Angular project. You're just being a bit more explicit in which files you want to include."),(0,r.kt)("h3",o({},{id:"plugins-cant-be-found-when-using-pnpm-as-package-manager"}),"Plugins can't be found when using pnpm as package manager"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Symptom")),(0,r.kt)("p",null,"Stryker is unable to load plugins (like ",(0,r.kt)("inlineCode",{parentName:"p"},"@stryker-mutator/typescript-checker"),") when using pnpm as package manager.\nYou might run into errors like:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{}),'Cannot find TestRunner plugin "mocha". No TestRunner plugins were loaded.\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Problem")),(0,r.kt)("p",null,"When using npm or yarn as package manager, Stryker can automagically load plugins by scanning your ",(0,r.kt)("inlineCode",{parentName:"p"},"node_modules"),".\nBecause ",(0,r.kt)("em",{parentName:"p"},"pnpm")," uses a special directory structure to store dependencies, Stryker can't auto-detect plugins like the ",(0,r.kt)("inlineCode",{parentName:"p"},"@stryker-mutator/typescript-checker")," plugin."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution")),(0,r.kt)("p",null,"Explicitly specify the plugins to load in your Stryker configuration file. "),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-diff"}),'{\n  "packageManager": "pnpm",\n  "testRunner": "jest",\n  "checkers": ["typescript"],\n+  "plugins": [\n+    "@stryker-mutator/jest-runner",\n+    "@stryker-mutator/typescript-checker"\n+  ]\n}\n')))}c.isMDXComponent=!0}}]);